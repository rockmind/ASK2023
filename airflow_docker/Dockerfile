ARG BASE_AIRFLOW_VERSION="2.5.3"
ARG IMAGE_PYTHON_VERSION="3.10"
ARG BASE_AIRFLOW_IMAGE_NAME="apache/airflow"
ARG BASE_AIRFLOW_IMAGE_TAG=slim-${BASE_AIRFLOW_VERSION}-python${IMAGE_PYTHON_VERSION}

FROM ${BASE_AIRFLOW_IMAGE_NAME}:${BASE_AIRFLOW_IMAGE_TAG}
RUN pip install --upgrade pip

ARG BASE_AIRFLOW_VERSION
ARG IMAGE_PYTHON_VERSION

ENV AIRFLOW_VERSION=$BASE_AIRFLOW_VERSION
ENV IMAGE_PYTHON_VERSION=$IMAGE_PYTHON_VERSION

RUN echo AIRFLOW_VERSION: $BASE_AIRFLOW_VERSION
RUN echo IMAGE_PYTHON_VERSION: $IMAGE_PYTHON_VERSION

COPY requirements.txt .
RUN pip install -r requirements.txt --no-cache-dir

RUN rm requirements.txt